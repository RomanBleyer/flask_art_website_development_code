<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Checkout</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css">
	<style>
		body {
			font-family: 'Poppins', sans-serif;
			background-color: #F8F8F0;
			min-height: 100vh;
			padding-top: 80px;
		}
		.checkout-card {
			background: #fff;
			border-radius: 20px;
			box-shadow: 0 8px 32px rgba(0,0,0,0.12);
			padding: 40px 30px;
			margin-top: 60px;
			margin-bottom: 60px;
		}
		.form-label {
			font-weight: 600;
		}
		.btn-checkout {
			background: #7BA7D7;
			color: #fff;
			font-weight: 600;
			font-size: 1.1rem;
			border-radius: 10px;
			padding: 12px 32px;
			transition: background 0.2s;
		}
		.btn-checkout:hover {
			background: #6a9bc9;
		}
		@media (max-width: 991px) {
			.checkout-card {
				padding: 25px 10px;
			}
		}
	</style>
</head>
<body>
	<nav style="background-color: white; height: 80px; width: 100%; position: fixed; top: 0; left: 0; z-index: 1000; display: flex; align-items: center; justify-content: space-between; padding: 0 40px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
		<div style="display: flex; align-items: center; flex: 1; gap: 18px; margin-left: 0;">
			<a href="/" style="display: block;">
				<img src="{{ url_for('static', filename='Website Images/logo.png') }}" alt="Logo" style="height: 80px; object-fit: cover; margin-right: 18px; display: block; margin-left: 0;">
			</a>
		</div>
		<div style="flex: 2; display: flex; justify-content: center; align-items: center; height: 100%;">
			<div class="search-container" style="max-width: 500px; width: 100%; display: flex; align-items: center; gap: 18px;">
				<a href="/storefront" style="text-decoration: none;">
					<button class="btn btn-primary" style="border-radius: 20px; font-family: 'Poppins', sans-serif; font-weight: 700; padding: 8px 18px; font-size: 1rem; height:44px; display:flex; align-items:center; background-color: #678FD8; color: white; border: none;">
						Storefront
					</button>
				</a>
				<form action="/search" method="get" class="input-group input-group-lg" autocomplete="off" style="position:relative;">
					<input type="text" class="form-control" name="q" id="search" placeholder="Search artworks..." style="font-size: 1.1rem; border-radius: 25px; border: 1px solid #ddd; font-weight: 500;" autocomplete="off">
					<div id="search-suggestions" style="position:absolute; top:100%; left:0; right:0; background:white; border-radius:0 0 15px 15px; box-shadow:0 4px 12px rgba(0,0,0,0.08); z-index:1001; display:none; max-height:320px; overflow-y:auto;"></div>
				</form>
				<script>
				const searchInput = document.getElementById('search');
				const suggestionsBox = document.getElementById('search-suggestions');
				let activeIndex = -1;
				let suggestions = [];
				searchInput.addEventListener('input', function() {
					const val = this.value.trim();
					if (val.length < 2) {
						suggestionsBox.style.display = 'none';
						return;
					}
					fetch(`/search_suggestions?q=${encodeURIComponent(val)}`)
						.then(res => res.json())
						.then(data => {
							suggestions = data;
							if (suggestions.length === 0) {
								suggestionsBox.style.display = 'none';
								return;
							}
							suggestionsBox.innerHTML = suggestions.map((s, i) => `
								<div class="d-flex align-items-center px-3 py-2 suggestion-item" style="cursor:pointer;" data-index="${i}">
									<img src="/static/Product_Images/${s.image}" alt="${s.name}" style="width:38px;height:38px;object-fit:cover;border-radius:8px;margin-right:12px;">
									<span style="font-weight:600;">${s.name}</span>
								</div>
							`).join('');
							suggestionsBox.style.display = 'block';
							activeIndex = -1;
						});
				});
				searchInput.addEventListener('keydown', function(e) {
					if (e.key === 'Enter') {
						// Prevent form submission on Enter
						e.preventDefault();
						return false;
					}
					if (suggestionsBox.style.display === 'none') return;
					if (e.key === 'ArrowDown') {
						activeIndex = Math.min(activeIndex + 1, suggestions.length - 1);
						updateActive();
						e.preventDefault();
					} else if (e.key === 'ArrowUp') {
						activeIndex = Math.max(activeIndex - 1, 0);
						updateActive();
						e.preventDefault();
					} else if (e.key === 'Enter' && activeIndex >= 0) {
						selectSuggestion(activeIndex);
						e.preventDefault();
					}
				});
				suggestionsBox.addEventListener('mousedown', function(e) {
					const item = e.target.closest('.suggestion-item');
					if (item) {
						selectSuggestion(parseInt(item.dataset.index));
					}
				});
				document.addEventListener('click', function(e) {
					if (!suggestionsBox.contains(e.target) && e.target !== searchInput) {
						suggestionsBox.style.display = 'none';
					}
				});
				function updateActive() {
					Array.from(suggestionsBox.children).forEach((el, i) => {
						el.style.background = i === activeIndex ? '#f0f8ff' : '';
					});
				}
				function selectSuggestion(idx) {
					if (suggestions[idx]) {
						window.location.href = `/product/${suggestions[idx].id}`;
					}
				}
				</script>
			</div>
		</div>
		<div style="flex: 1; display: flex; justify-content: flex-end; align-items: center; gap: 15px;">
			{% if session.get('user') %}
				<div style="display: flex; align-items: center; gap: 10px;">
					{% if session.get('is_admin') %}
					<a href="/admin" style="text-decoration: none;">
						<button class="btn btn-outline-warning" style="border-radius: 20px; font-family: 'Poppins', sans-serif; font-weight: 500; padding: 8px 16px; margin-right: 5px; color: #f0ad4e; border: 2px solid #f0ad4e; background: white; display: flex; align-items: center; gap: 8px;">
							<i class="fa fa-cog"></i> Admin
						</button>
					</a>
					{% endif %}
					<span style="font-family: 'Poppins', sans-serif; font-weight: 500; color: #333; white-space: nowrap; display: inline-block;">
						{{ session.get('first_name', '') }} {{ session.get('last_name', '') }}
					</span>
					<a href="#" style="text-decoration: none;">
						<button class="btn btn-outline-secondary" style="border-radius: 50%; width: 44px; height: 44px; display: flex; align-items: center; justify-content: center; font-size: 1.3rem;">
							<i class="fa fa-user"></i>
						</button>
					</a>
					<a href="/logout" style="text-decoration: none;">
						<button class="btn btn-outline-danger" style="border-radius: 20px; font-family: 'Poppins', sans-serif; font-weight: 500; padding: 8px 16px; margin-left: 5px;">
							Logout
						</button>
					</a>
				</div>
			{% else %}
				<a href="/login" style="text-decoration: none;">
					<button class="btn btn-outline-primary" style="border-radius: 20px; font-family: 'Poppins', sans-serif; font-weight: 500; display: flex; align-items: center; gap: 8px; padding: 8px 16px;">
						Login
					</button>
				</a>
				<a href="/signup" style="text-decoration: none;">
					<button class="btn btn-primary" style="border-radius: 20px; font-family: 'Poppins', sans-serif; font-weight: 500; display: flex; align-items: center; gap: 8px; padding: 8px 16px; background-color: #7BA7D7; border-color: #7BA7D7;">
						Sign Up
					</button>
				</a>
			{% endif %}
			<a href="/cart" style="text-decoration: none;">
				<button class="btn btn-outline-success" style="border-radius: 20px; font-family: 'Poppins', sans-serif; font-weight: 500; display: flex; align-items: center; gap: 8px; padding: 8px 16px;">
					<i class="fa fa-shopping-cart"></i> Cart
				</button>
			</a>
		</div>
	</nav>
	<div class="container d-flex justify-content-center align-items-center" style="min-height: 100vh;">
		<div class="row w-100 justify-content-center">
			<div class="col-lg-8">
				<div class="checkout-card">
					<h2 class="mb-4">Checkout</h2>
					<form method="post" id="checkoutForm">
						<div class="mb-3">
							<div class="row">
								<div class="col-md-6 mb-2">
									<label for="first_name" class="form-label">First Name</label>
									<input type="text" class="form-control" id="first_name" name="first_name" required value="{{ first_name }}">
								</div>
								<div class="col-md-6 mb-2">
									<label for="last_name" class="form-label">Last Name</label>
									<input type="text" class="form-control" id="last_name" name="last_name" required value="{{ last_name }}">
								</div>
							</div>
						</div>
						<div class="mb-3">
							<label for="email" class="form-label">Email Address</label>
							<input type="email" class="form-control" id="email" name="email" required value="{{ user_email }}">
						</div>
						<div class="mb-3">
							<label class="form-label">Address</label>
							<div class="row g-2">
								<div class="col-12 mb-2">
									<input type="text" class="form-control" id="street" name="street" placeholder="Street Address" required>
								</div>
								<div class="col-md-6 mb-2">
									<input type="text" class="form-control" id="city" name="city" placeholder="City" required>
								</div>
								<div class="col-md-4 mb-2">
									<input type="text" class="form-control" id="state" name="state" placeholder="State/Province" required>
								</div>
								<div class="col-md-2 mb-2">
									<input type="text" class="form-control" id="zip" name="zip" placeholder="ZIP" required>
								</div>
								<div class="col-12">
									<input type="text" class="form-control" id="country" name="country" placeholder="Country" required>
							</div>
						</div>
						<div class="form-check mt-2">
							<input class="form-check-input" type="checkbox" value="1" id="remember_address" name="remember_address">
							<label class="form-check-label" for="remember_address">
								Remember this address
							</label>
						</div>
						</div>
						<hr>
						<h5 class="mb-3">Card Information</h5>
						<div class="mb-3">
							<label for="card_number" class="form-label">Card Number</label>
							<input type="text" class="form-control" id="card_number" name="card_number" maxlength="19" placeholder="1234 5678 9012 3456" value="1234 5678 9012 3456" readonly disabled>
						</div>
						<div class="row">
							<div class="col-md-6 mb-3">
								<label for="expiry" class="form-label">Expiry Date</label>
								<input type="text" class="form-control" id="expiry" name="expiry" maxlength="5" placeholder="MM/YY" value="12/34" readonly disabled>
							</div>
							<div class="col-md-6 mb-3">
								<label for="cvc" class="form-label">CVC</label>
								<input type="text" class="form-control" id="cvc" name="cvc" maxlength="4" placeholder="CVC" value="123" readonly disabled>
							</div>
						</div>
						<hr>
						<div class="mb-3">
							<h5>Total Cost: <span id="totalCost">${{ total_cost }}</span></h5>
						</div>
						<button type="submit" class="btn btn-checkout">Place Order</button>
					</form>
				</div>
			</div>
		</div>
	</div>

</body>
<footer style="background: linear-gradient(90deg, #7BA7D7 0%, #678FD8 100%); color: white; padding: 50px 0 0 0; margin-top: 60px; width: 100%;">
	<div style="max-width: 1300px; margin: 0 auto; display: flex; flex-wrap: wrap; justify-content: space-between; align-items: flex-start; gap: 40px; padding: 0 50px 30px 50px;">
		<div style="min-width: 250px;">
			<h2 style="color: white; font-family: 'Poppins', sans-serif; font-size: 2.5rem; font-weight: 700; margin: 0;">Collectors Delight</h2>
		</div>
		<div style="min-width: 160px;"></div>
		<div style="min-width: 200px;">
			<h4 style="color: white; font-family: 'Poppins', sans-serif; font-size: 1.1rem; font-weight: 600; margin: 0 0 15px 0;">Page Links</h4>
			<p style="margin: 5px 0;"><a href="/" style="color: rgba(255,255,255,0.8); text-decoration: none; font-family: 'Poppins', sans-serif; font-size: 0.9rem;">Home</a></p>
			<p style="margin: 5px 0;"><a href="/storefront" style="color: rgba(255,255,255,0.8); text-decoration: none; font-family: 'Poppins', sans-serif; font-size: 0.9rem;">Storefront</a></p>
			<p style="margin: 5px 0;"><a href="/cart" style="color: rgba(255,255,255,0.8); text-decoration: none; font-family: 'Poppins', sans-serif; font-size: 0.9rem;">Cart</a></p>
		</div>
		<div style="flex: 1; min-width: 200px; margin-bottom: 30px;">
			<p style="margin: 5px 0;"><a href="/login" style="color: rgba(255,255,255,0.8); text-decoration: none; font-family: 'Poppins', sans-serif; font-size: 0.9rem;">Login</a></p>
			<p style="margin: 5px 0;"><a href="/signup" style="color: rgba(255,255,255,0.8); text-decoration: none; font-family: 'Poppins', sans-serif; font-size: 0.9rem;">Sign Up</a></p>
			<p style="margin: 5px 0;"><a href="/terms" style="color: rgba(255,255,255,0.8); text-decoration: none; font-family: 'Poppins', sans-serif; font-size: 0.9rem;">Terms & Conditions</a></p>
		</div>
	</div>
	<div style="border-top: 1px solid rgba(255,255,255,0.2); padding-top: 20px; text-align: center;">
		<p style="color: rgba(255,255,255,0.7); font-family: 'Poppins', sans-serif; font-size: 0.9rem; margin: 0;">Â© 2025 Collectors Delight. All rights reserved.</p>
	</div>
</footer>
</html>
